# 基础二

## 1. 视图

就是给临时表起一个别名，方便在多个地方使用。我们称这个过程为创建视图。

### 创建视图

```sql
create view [view_name] as SQL
```

举例：

```sql
create view v1 as 
	select * from student;
select * from v1;
```

### 修改视图

```sql
alter view [view_name] as SQL;
```

举例：

```sql
alter view v1 as
    select sid from student;
```

### 删除视图

```sql
drop view [view_name]
```

> 视图不能插入数据。
>
> 尽量不要使用视图。可读性和扩展性都不好。

## 2.触发器

当对某张表进行增删改操作时，触发其他增删改的操作。

举例：

```sql
# 创建触发器，表示每次向student表里插入数据之前先往teacher表里插入一条
create trigger t1 before insert on student for each row
    begin
        # 要执行的内容，不能是查询
        insert into teacher (tname) values ('天海翼');
        insert into classes (caption) values (NEW.sname);
    end;

insert into student (sname, gender, class_id) VALUES ('大锤', '男', '1');
select * from teacher;
```

还可以使用 `New` 和 `old` 关键字

> 也不推荐使用。可读性和扩展性都不好。

## 3.函数

### 内置函数

有很多种，参考 [内置函数](https://www.cnblogs.com/noway-neway/p/5211401.html) 。

举例：

```sql
select current_date(); # 当前日期，2020-08-22
select current_time(); # 当前时间，需要设置时区，15:16:02
select current_timestamp(); # 日期和时间，2020-08-22 15:24:04
select date_format(current_date(), '%Y-%m'); # 格式化时间
select char_length('good');
```

### 自定义函数

几乎用不到，忽略。

> 但是在SQL语句中使用内置函数会降低查询效率。尽量少用。可以在程序级别进行。

## 4.存储过程

用于定义很多sql语句。方便复用。

举例：

```sql
# 创建存储过程
create procedure p1(in n1 int)
begin
    select * from student where sid > n1;
    select * from teacher;
    # 还可以写很多其他的sql语句
end;
# 调用存储过程
call p1();
```

存储过程可以支持事务，也许在金融类的框架里用得比较多。

> 也使用得比较少。一般的程序框架都会使用ROM。

